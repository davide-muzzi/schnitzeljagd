<ion-content class="leaderboard-page">
  <!-- FIXED HEADER -->
  <div class="header">
    <button class="back-btn" (click)="goHome()">
      <img src="assets/icons/arrow_left.svg" alt="Back" />
    </button>

    <div class="header-stack">
      <div class="header-icon">
        <img src="assets/icons/crown_white.svg" alt="Crown" />
      </div>

      <h1>Leaderboard</h1>
      <p class="subtitle">Die besten Schnitzel-J채ger</p>
    </div>
  </div>

  <!-- SCROLLABLE CONTENT -->
  <div class="content">
    <!-- HALL OF FAME -->
    <div class="section-title hall">
      <img src="assets/icons/lightning_bolt_yellow.svg" alt="Hall" />
      Hall of Fame
    </div>

    <ng-container *ngFor="let podium of topThree; let idx = index">
      <div class="podium-card" [ngClass]="'podium-' + (idx + 1)">
        <div
          class="podium-left"
          [ngClass]="{
            'left-gold': idx === 0,
            'left-silver': idx === 1,
            'left-bronze': idx === 2
          }"
        >
          <img
            [src]="idx === 0 ? 'assets/icons/trophy.svg' : 'assets/icons/medal.svg'"
            [alt]="idx === 0 ? 'Trophy' : 'Medal'"
          />
        </div>

        <div class="podium-mid">
          <div class="podium-name">
            {{ podium?.name || 'Noch kein Lauf' }}
            <img
              *ngIf="idx === 0 && podium"
              src="assets/icons/crown_yellow.svg"
              class="mini-crown"
              alt="Crown"
            />
          </div>
          <div class="podium-meta">
            {{ podium?.dateIso ? (podium?.dateIso | date: 'dd.MM.yyyy HH:mm') :
            'Kein Datum' }}
          </div>
        </div>

        <div class="podium-right">
          <div class="podium-points">{{ podium?.points ?? '---' }}</div>
          <div class="podium-label">Punkte</div>
        </div>
      </div>
    </ng-container>

    <!-- MORE RANKINGS -->
    <div class="section-title purple">
      <img src="assets/icons/trending_up_purple.svg" alt="Trending" />
      Weitere Rankings
    </div>

    <!-- #4?#7 -->
    <div
      class="rank-card"
      *ngFor="let rank of nextRanks; let idx = index; trackBy: trackByIndex"
    >
      <div class="rank">#{{ idx + 4 }}</div>
      <div class="rank-mid">
        <div class="rank-name">{{ rank?.name || 'Noch kein Lauf' }}</div>
        <div class="rank-meta">
          {{ rank?.dateIso ? (rank?.dateIso | date: 'dd.MM.yyyy HH:mm') : 'Kein
          Datum' }}
        </div>
      </div>
      <div class="rank-right">
        <div class="rank-points">{{ rank?.points ?? '---' }}</div>
        <div class="rank-label">Punkte</div>
      </div>
    </div>

    <!-- ALL RUNS (HISTORY) -->
    <ng-container *ngIf="hasRuns; else emptyHistory">
      <div class="history">
        <div class="history-title">Alle Durchl채ufe</div>
        <div
          class="history-item"
          *ngFor="let run of allRuns; trackBy: trackByIndex"
        >
          {{ run?.name }} ? {{ run?.dateIso | date: 'dd.MM.yyyy HH:mm' }} ? {{
          run?.points }} pts
        </div>
      </div>
    </ng-container>
    <ng-template #emptyHistory>
      <div class="history">
        <div class="history-title">Alle Durchl채ufe</div>
        <div class="history-item">Noch keine Ergebnisse gespeichert.</div>
      </div>
    </ng-template>

    <!-- AVERAGE -->
    <div class="average-card">
      <div class="avg-title">Durchschnittliche Punktzahl</div>
      <div class="avg-value">{{ averagePoints }}</div>
      <div class="avg-sub">Basierend auf {{ totalRuns }} Durchl채ufen</div>
    </div>
  </div>
</ion-content>
